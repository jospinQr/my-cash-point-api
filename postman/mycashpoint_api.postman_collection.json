{
  "info": {
    "_postman_id": "8d0c980c-5b41-4bf7-9a6f-df47885e6e9c",
    "name": "MyCashPoint API",
    "description": "Collection Postman pour tester l'API MyCashPoint (authentification, agences, opérateurs, soldes et transactions) avec pagination et création de transactions en lot.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Inscription",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\",\n  \"role\": \"ADMIN\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/register",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "register"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Connexion",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const json = pm.response.json();",
                  "    if (json.token) {",
                  "        pm.collectionVariables.set(\"jwtToken\", json.token);",
                  "        pm.test(\"Jeton sauvegardé\", function () {",
                  "            pm.expect(pm.collectionVariables.get(\"jwtToken\")).to.eql(json.token);",
                  "        });",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"admin\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "auth",
                "login"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Agences",
      "item": [
        {
          "name": "Créer une agence",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"AG001\",\n  \"name\": \"Agence Centrale\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/agence",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "agence"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les agences",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/agence",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "agence"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Récupérer une agence par code",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/agence/:code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "agence",
                ":code"
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "AG001"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Mettre à jour une agence",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"AG001\",\n  \"name\": \"Agence Centrale Mise à jour\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/agence/:code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "agence",
                ":code"
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "AG001"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Supprimer une agence",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/agence/:code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "agence",
                ":code"
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "AG001"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Opérateurs",
      "item": [
        {
          "name": "Créer un opérateur",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Vodacom\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/operateur",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "operateur"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les opérateurs",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/operateur",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "operateur"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Récupérer un opérateur par id",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/operateur/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "operateur",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Mettre à jour un opérateur",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Vodacom Mise à jour\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/operateur/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "operateur",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Supprimer un opérateur",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/operateur/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "operateur",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Soldes",
      "item": [
        {
          "name": "Créer un solde",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"operateurId\": 1,\n  \"soldeType\": \"PHYSIQUE\",\n  \"montant\": 1500.00,\n  \"deviseCode\": \"USD\",\n  \"seuilAlerte\": 200.0,\n  \"misAJourPar\": 1,\n  \"dernierMiseAJour\": 1731369600000,\n  \"codeAgence\": \"AG001\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/solde",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Créer un solde (doublon attendu 400)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"operateurId\": 1,\n  \"soldeType\": \"PHYSIQUE\",\n  \"montant\": 1500.00,\n  \"deviseCode\": \"USD\",\n  \"seuilAlerte\": 200.0,\n  \"misAJourPar\": 1,\n  \"dernierMiseAJour\": 1731369600000,\n  \"codeAgence\": \"AG001\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/solde",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les soldes",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Récupérer un solde par id",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les soldes par opérateur",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde/operateur/:operateurId",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                "operateur",
                ":operateurId"
              ],
              "variable": [
                {
                  "key": "operateurId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les soldes par agence",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde/agence/:code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                "agence",
                ":code"
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "AG001"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les soldes par type",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde/type/:type",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                "type",
                ":type"
              ],
              "variable": [
                {
                  "key": "type",
                  "value": "PHYSIQUE"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les soldes par devise",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde/devise/:code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                "devise",
                ":code"
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "USD"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Mettre à jour un solde",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"operateurId\": 1,\n  \"soldeType\": \"PHYSIQUE\",\n  \"montant\": 1750.00,\n  \"deviseCode\": \"USD\",\n  \"seuilAlerte\": 200.0,\n  \"misAJourPar\": 2,\n  \"dernierMiseAJour\": 1731456000000,\n  \"codeAgence\": \"AG001\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/solde/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Mettre à jour ou créer un solde (upsert)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"operateurId\": 1,\n  \"soldeType\": \"PHYSIQUE\",\n  \"montant\": 1800.00,\n  \"deviseCode\": \"USD\",\n  \"seuilAlerte\": 250.0,\n  \"misAJourPar\": 3,\n  \"dernierMiseAJour\": 1731552400000,\n  \"codeAgence\": \"AG001\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/solde/operateur/:operateurId",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                "operateur",
                ":operateurId"
              ],
              "variable": [
                {
                  "key": "operateurId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Supprimer un solde",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/solde/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "solde",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Transactions",
      "item": [
        {
          "name": "Créer une transaction",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"operateurId\": 1,\n  \"type\": \"DEPOT\",\n  \"montant\": 250.00,\n  \"transactionCode\": \"TXN-001\",\n  \"commission\": 5.0,\n  \"nomClient\": \"Jean Doe\",\n  \"numClient\": \"+243812345678\",\n  \"nomBeneficaire\": \"Marie Doe\",\n  \"numBeneficaire\": \"+243972345678\",\n  \"soldeAvant\": 1000.00,\n  \"soldeApres\": 750.00,\n  \"deviseCode\": \"USD\",\n  \"reference\": \"REF-2024-01\",\n  \"note\": \"Dépôt initial\",\n  \"codeAgence\": \"AG001\",\n  \"creePar\": 1\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/transaction",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Créer plusieurs transactions",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "[\n  {\n    \"operateurId\": 1,\n    \"type\": \"DEPOT\",\n    \"montant\": 250.00,\n    \"transactionCode\": \"TXN-LOT-001\",\n    \"commission\": 5.0,\n    \"nomClient\": \"Jean Doe\",\n    \"numClient\": \"+243812345678\",\n    \"nomBeneficaire\": \"Marie Doe\",\n    \"numBeneficaire\": \"+243972345678\",\n    \"soldeAvant\": 1000.00,\n    \"soldeApres\": 750.00,\n    \"deviseCode\": \"USD\",\n    \"reference\": \"REF-2024-LOT-01\",\n    \"note\": \"Dépôt initial lot\",\n    \"codeAgence\": \"AG001\",\n    \"creePar\": 1\n  },\n  {\n    \"operateurId\": 1,\n    \"type\": \"RETRAIT\",\n    \"montant\": 150.00,\n    \"deviseCode\": \"USD\",\n    \"codeAgence\": \"AG001\",\n    \"creePar\": 1\n  }\n]"
            },
            "url": {
              "raw": "{{baseUrl}}/transaction/batch",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                "batch"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les transactions (paginé)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction?page={{page}}&size={{size}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "{{page}}",
                  "description": "Indice de page (0 basé)"
                },
                {
                  "key": "size",
                  "value": "{{size}}",
                  "description": "Nombre d'éléments par page"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Récupérer une transaction par id",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les transactions par opérateur",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/operateur/:operateurId",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                "operateur",
                ":operateurId"
              ],
              "variable": [
                {
                  "key": "operateurId",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les transactions par agence (paginé)",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/agence/:code?page={{page}}&size={{size}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                "agence",
                ":code"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "{{page}}",
                  "description": "Indice de page (0 basé)"
                },
                {
                  "key": "size",
                  "value": "{{size}}",
                  "description": "Nombre d'éléments par page"
                }
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "AG001"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les transactions par type",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/type/:type",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                "type",
                ":type"
              ],
              "variable": [
                {
                  "key": "type",
                  "value": "DEPOT"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Lister les transactions par période",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/periode?start={{startTs}}&end={{endTs}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                "periode"
              ],
              "query": [
                {
                  "key": "start",
                  "value": "{{startTs}}",
                  "description": "Horodatage de début (epoch ms)"
                },
                {
                  "key": "end",
                  "value": "{{endTs}}",
                  "description": "Horodatage de fin (epoch ms)"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Récupérer une transaction par code",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/code/:code",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                "code",
                ":code"
              ],
              "variable": [
                {
                  "key": "code",
                  "value": "TXN-001"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Supprimer une transaction",
          "request": {
            "auth": {
              "type": "bearer",
              "bearer": [
                {
                  "key": "token",
                  "value": "{{jwtToken}}",
                  "type": "string"
                }
              ]
            },
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/transaction/:id",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "transaction",
                ":id"
              ],
              "variable": [
                {
                  "key": "id",
                  "value": "1"
                }
              ]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080"
    },
    {
      "key": "jwtToken",
      "value": ""
    },
    {
      "key": "startTs",
      "value": "1731283200000"
    },
    {
      "key": "endTs",
      "value": "1731456000000"
    },
    {
      "key": "page",
      "value": "0"
    },
    {
      "key": "size",
      "value": "20"
    }
  ]
}

